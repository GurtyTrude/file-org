def launch_gui():
    root = tk.Tk()
    root.title("File Renamer")

    # Make the main window resizable (both directions)
    root.resizable(True, True)

    # Optional: you can still give an initial size
    root.geometry("500x250")

    # StringVars for paths and options
    excel_path_var = tk.StringVar()
    target_folder_var = tk.StringVar()
    file_ext = tk.StringVar(value=".pdf")
    mode_var = tk.StringVar(value="Prefix")  # "Prefix" or "Replace"

    padding_x = 10
    padding_y = 5

    def choose_excel():
        path = filedialog.askopenfilename(
            filetypes=[("Excel files", "*.xlsx;*.xls;*.xlsm;*.xlsb"), ("All files", "*.*")]
        )
        if path:
            excel_path_var.set(path)

    def choose_folder():
        path = filedialog.askdirectory()
        if path:
            target_folder_var.set(path)

    def on_continue():
        excel_path = excel_path_var.get().strip()
        target_folder = target_folder_var.get().strip()
        ext = file_ext.get().strip()
        mode = mode_var.get()

        if not excel_path or not os.path.isfile(excel_path):
            messagebox.showerror("Error", "Please select a valid Excel file.")
            return
        if not target_folder or not os.path.isdir(target_folder):
            messagebox.showerror("Error", "Please select a valid target folder.")
            return
        if not ext.startswith("."):
            messagebox.showerror("Error", "File extension must start with a dot, e.g. .pdf")
            return

        log_path = rename_files_from_excel(excel_path, target_folder, ext, mode)
        if log_path:
            messagebox.showinfo("Success", f"Renaming complete.\nLog saved to:\n{log_path}")

    def on_quit():
        root.destroy()

    def save_excel_template():
        path = filedialog.asksaveasfilename(
            defaultextension=".xlsx",
            filetypes=[("Excel files", "*.xlsx")]
        )
        if not path:
            return

        df = pd.DataFrame({"Prefix": ["1", "2"], "Filename": ["PDF-A", "PDF-B"]})
        try:
            df.to_excel(path, index=False)
            messagebox.showinfo("Template Created", f"Template saved to:\n{path}")
        except Exception as e:
            messagebox.showerror("Error", f"Could not save file:\n{e}")

    # --- Layout ---

    # Excel file row
    lbl_excel = tk.Label(root, text="Excel File:")
    lbl_excel.grid(row=0, column=0, padx=padding_x, pady=padding_y, sticky="e")

    entry_excel = tk.Entry(root, textvariable=excel_path_var, width=40)
    entry_excel.grid(row=0, column=1, padx=padding_x, pady=padding_y, sticky="we")

    btn_excel = tk.Button(root, text="Browse", command=choose_excel)
    btn_excel.grid(row=0, column=2, padx=padding_x, pady=padding_y, sticky="w")

    # Target folder row
    lbl_folder = tk.Label(root, text="Target Folder:")
    lbl_folder.grid(row=1, column=0, padx=padding_x, pady=padding_y, sticky="e")

    entry_folder = tk.Entry(root, textvariable=target_folder_var, width=40)
    entry_folder.grid(row=1, column=1, padx=padding_x, pady=padding_y, sticky="we")

    btn_folder = tk.Button(root, text="Browse", command=choose_folder)
    btn_folder.grid(row=1, column=2, padx=padding_x, pady=padding_y, sticky="w")

    # File extension row
    lbl_ext = tk.Label(root, text="File Extension:")
    lbl_ext.grid(row=2, column=0, padx=padding_x, pady=padding_y, sticky="e")

    entry_ext = tk.Entry(root, textvariable=file_ext, width=10)
    entry_ext.grid(row=2, column=1, padx=padding_x, pady=padding_y, sticky="w")

    # Mode dropdown row
    lbl_mode = tk.Label(root, text="Rename Mode:")
    lbl_mode.grid(row=3, column=0, padx=padding_x, pady=padding_y, sticky="e")

    mode_menu = tk.OptionMenu(root, mode_var, "Prefix", "Replace")
    mode_menu.grid(row=3, column=1, padx=padding_x, pady=padding_y, sticky="w")

    # Buttons row
    btn_template = tk.Button(root, text="Save Excel Template", command=save_excel_template)
    btn_template.grid(row=4, column=0, padx=padding_x, pady=padding_y, sticky="w")

    btn_run = tk.Button(root, text="Run", command=on_continue, width=12)
    btn_run.grid(row=4, column=1, padx=padding_x, pady=padding_y, sticky="e")

    btn_quit = tk.Button(root, text="Quit", command=on_quit, width=10)
    btn_quit.grid(row=4, column=2, padx=padding_x, pady=padding_y, sticky="e")

    # Make columns 1 expand when window is resized
    root.columnconfigure(1, weight=1)

    root.mainloop()
